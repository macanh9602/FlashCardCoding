<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard Master</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container mt-4">
        <header class="text-center mb-4">
            <div id="auth-container">
            </div>
            <h1>Flashcard Master 🎓</h1>
            <p class="lead">Your personal vocabulary learning platform (Beta)</p>
        </header>

        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="library-tab" data-bs-toggle="tab" data-bs-target="#library-pane"
                    type="button" role="tab">📚 Libraries</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="add-card-tab" data-bs-toggle="tab" data-bs-target="#add-card-pane"
                    type="button" role="tab">➕ Add New Card</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="quiz-tab" data-bs-toggle="tab" data-bs-target="#quiz-pane" type="button"
                    role="tab">🧠 Practice FlashCard</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="synonym-quiz-tab" data-bs-toggle="tab" data-bs-target="#synonym-quiz-pane"
                    type="button" role="tab">📝 Practice Synonyms</button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active p-3" id="library-pane" role="tabpanel">
                <h4>Manage Decks</h4>
                <div class="input-group mb-3">
                    <input type="text" id="new-deck-input" class="form-control" placeholder="New deck name...">
                    <button id="add-deck-btn" class="btn btn-primary">Create</button>
                </div>

                <div id="deck-list" class="row g-3">
                </div>
                <hr>
                <div class="my-3 p-3 bg-light border rounded">
                    <h5>Data Tools</h5>
                    <p class="small text-muted">Use this feature to automatically find and add synonyms for all
                        old cards that don't have them. This process may take a few minutes depending on the number of
                        cards you have.</p>
                    <button id="batch-update-synonyms-btn" class="btn btn-info">🚀 Run Batch Synonym Update</button>
                </div>
                <h4 id="cards-list-title" class="mt-4">All Cards</h4>
                <div id="cards-list" class="list-group">
                </div>
            </div>

            <div class="tab-pane fade p-3" id="add-card-pane" role="tabpanel">
                <h4>Add New Knowledge Card</h4>
                <div class="form-group mb-2">
                    <label for="deck-select">Select Deck</label>
                    <select id="deck-select" class="form-select"></select>
                </div>
                <div class="form-group mb-2">
                    <label for="front-input">Front (English)</label>
                    <div class="input-group">
                        <input type="text" id="front-input" class="form-control" placeholder="Enter English word...">
                        <button class="btn btn-outline-secondary" type="button" id="search-synonyms-btn">🔍 Find
                            Synonyms Automatically</button>
                    </div>
                </div>

                <div id="synonyms-manager" class="mt-3">
                    <label class="form-label">Synonym List (can add/edit/delete):</label>
                    <div id="synonyms-list" class="mb-2">
                    </div>
                    <div class="input-group input-group-sm">
                        <input type="text" id="manual-synonym-input" class="form-control" placeholder="Add manually...">
                        <button class="btn btn-outline-success" type="button" id="add-synonym-btn">Add</button>
                    </div>
                </div>
                <div class="form-group mb-3 mt-3">
                    <label for="back-input">Back (Vietnamese Meaning & Example)</label>
                    <textarea id="back-input" class="form-control" rows="4"></textarea>
                </div>
                <button id="save-card-btn" class="btn btn-success">Save Card</button>
            </div>

            <div class="tab-pane fade p-3" id="quiz-pane" role="tabpanel">
                <div id="quiz-setup">
                    <div class="section-box">
                        <h3>Start Quiz</h3>
                        <div class="setup-row mb-3">
                            <label for="quiz-deck-filter" class="form-label">Select Deck:</label>
                            <select id="quiz-deck-filter" class="form-select"></select>
                        </div>
                        <div class="setup-row mb-3">
                            <label for="quiz-direction" class="form-label">Direction:</label>
                            <select id="quiz-direction" class="form-select">
                                <option value="front-to-back">Front ➤ Back</option>
                                <option value="back-to-front">Back ➤ Front</option>
                            </select>
                        </div>
                        <div class="setup-row statuses mb-3">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input status-filter" type="checkbox" value="chua-thuoc"
                                    id="check-chua-thuoc" checked>
                                <label class="form-check-label" for="check-chua-thuoc">Not Learned</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input status-filter" type="checkbox" value="tam-on"
                                    id="check-tam-on" checked>
                                <label class="form-check-label" for="check-tam-on">Moderately Learned</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input status-filter" type="checkbox" value="da-thuoc"
                                    id="check-da-thuoc">
                                <label class="form-check-label" for="check-da-thuoc">Fully Learned</label>
                            </div>
                        </div>
                        <button id="start-quiz-btn" class="btn btn-primary btn-lg">🚀 Start!</button>
                    </div>
                </div>
                <div id="quiz-view" class="hidden">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <button id="end-quiz-btn" class="btn btn-sm btn-outline-secondary">End</button>
                        <h4 id="quiz-progress" class="mb-0"></h4>
                    </div>
                    <div class="quiz-card">
                        <div class="quiz-card-inner">
                            <div class="quiz-card-front">
                                <div id="quiz-front" class="card-title"></div>
                                <div id="quiz-ipa" class="card-subtitle text-muted"></div>
                            </div>
                            <div class="quiz-card-back">
                                <div id="quiz-back" class="card-text"></div>
                            </div>
                        </div>
                    </div>
                    <div class="quiz-controls mt-3 text-center">
                        <div id="tts-buttons" class="d-inline-block">
                            <button id="tts-us-btn" class="btn btn-info">🔊 US</button>
                            <button id="tts-uk-btn" class="btn btn-info">🔊 UK</button>
                        </div>
                    </div>
                    <div id="status-buttons" class="mt-3 text-center hidden">
                        <button class="btn btn-danger status-btn" data-status="chua-thuoc">🟥 Not Learned</button>
                        <button class="btn btn-warning status-btn" data-status="tam-on">🟨 Moderately Learned</button>
                        <button class="btn btn-success status-btn" data-status="da-thuoc">🟩 Fully Learned</button>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade p-3" id="synonym-quiz-pane" role="tabpanel">
                <div id="synonym-quiz-setup">
                    <div class="section-box">
                        <h3>Practice Synonyms</h3>
                        <p>The system will present a word, and you must choose the most appropriate synonym from the
                            options below.
                        </p>
                        <div class="setup-row mb-3">
                            <label class="form-label">Select the decks to study:</label>
                            <div id="synonym-deck-checkboxes" class="border rounded p-2"
                                style="max-height: 150px; overflow-y: auto;">
                            </div>
                            <div class="form-check mt-2">
                                <input class="form-check-input" type="checkbox" id="synonym-toggle-all-decks" checked>
                                <label class="form-check-label" for="synonym-toggle-all-decks">
                                    Select All / Deselect All
                                </label>
                            </div>
                        </div>
                        <div class="setup-row mb-3">
                            <label class="form-label">Choose difficulty level:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="difficulty-level" id="level-easy"
                                    value="easy" checked>
                                <label class="form-check-label" for="level-easy">
                                    <strong>Normal:</strong> Choose 1 correct answer only.
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="difficulty-level" id="level-hard"
                                    value="hard">
                                <label class="form-check-label" for="level-hard">
                                    <strong>Hard:</strong> Choose ALL correct answers.
                                </label>
                            </div>
                        </div>
                        <button id="start-synonym-quiz-btn" class="btn btn-info btn-lg">💡 Start Now!</button>
                    </div>
                </div>
                <div id="synonym-quiz-view" class="hidden">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <button id="end-synonym-quiz-btn" class="btn btn-sm btn-outline-secondary">End</button>
                        <h4 id="synonym-quiz-progress" class="mb-0"></h4>
                    </div>
                    <div class="text-center">
                        <p class="lead">Find a synonym for:</p>
                        <h2 id="synonym-question-word" class="display-4 my-4"></h2>
                        <div id="synonym-options-container" class="d-grid gap-2 col-6 mx-auto">
                        </div>
                        <button id="check-synonym-answer-btn" class="btn btn-primary mt-4 hidden">Check answer</button>

                        <div id="synonym-feedback" class="mt-3"></div>
                        <button id="next-synonym-question-btn" class="btn btn-primary mt-4 hidden">Next Question
                            ➔</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="info-modal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="info-modal-title">Word Info</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="info-modal-body"></div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="import-options-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Import Options</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>How would you like to process the data from the file?</p>
                    <div class="d-grid gap-2">
                        <button type="button" class="btn btn-primary" id="merge-data-btn">
                            <strong>Merge (Safe)</strong>
                            <small class="d-block">Only add new decks and cards. Current data will be preserved.</small>
                        </button>
                        <button type="button" class="btn btn-danger" id="replace-data-btn">
                            <strong>Replace (Delete Old Data)</strong>
                            <small class="d-block">Delete all current data and replace it with data from the
                                file.</small>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="edit-modal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Card</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="edit-card-id">
                    <div class="form-group mb-2">
                        <label for="edit-deck-select">Deck</label>
                        <select id="edit-deck-select" class="form-select"></select>
                    </div>
                    <div class="form-group mb-2">
                        <label for="edit-front-input">Front</label>
                        <div class="input-group">
                            <input type="text" id="edit-front-input" class="form-control">
                            <button class="btn btn-outline-secondary" type="button" id="edit-search-synonyms-btn">🔍
                                Search</button>
                        </div>
                    </div>

                    <div id="edit-synonyms-manager" class="mt-3">
                        <label class="form-label">Synonyms List:</label>
                        <div id="edit-synonyms-list" class="mb-2">
                        </div>
                        <div class="input-group input-group-sm">
                            <input type="text" id="edit-manual-synonym-input" class="form-control"
                                placeholder="Add manually...">
                            <button class="btn btn-outline-success" type="button" id="edit-add-synonym-btn">Add</button>
                        </div>
                    </div>
                    <div class="form-group mb-3 mt-3">
                        <label for="edit-back-input">Back</label>
                        <textarea id="edit-back-input" class="form-control" rows="4"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-edit-btn">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="script.js"></script>
</body>

</html>